% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seurat.R
\name{sn_calculate_rogue}
\alias{sn_calculate_rogue}
\title{Calculate ROGUE Score(s) from a Seurat Object}
\usage{
sn_calculate_rogue(
  x,
  clusters = NULL,
  label = NULL,
  span = 0.9,
  min_cells = 10,
  min_genes = 10,
  platform = "UMI",
  cutoff = 0.05,
  features = NULL,
  verbose = TRUE
)
}
\arguments{
\item{x}{A Seurat object with a \code{counts} layer.}

\item{clusters}{\emph{(optional)} Character vector of metadata column names containing clustering info.
If provided, \code{label} must also be provided.}

\item{label}{\emph{(optional)} A metadata column name specifying sample identity. Required when \code{clusters} is used.}

\item{span}{Smoothing parameter used in \code{ROGUE::rogue()} when \code{clusters} and \code{label} are used. Default is \code{0.9}.}

\item{min_cells}{Minimum number of cells a gene must be detected in. Default: \code{10}.}

\item{min_genes}{Minimum number of genes each cell must express. Default: \code{10}.}

\item{platform}{Character string, either \code{"UMI"} or \code{"full-length"} to match sequencing platform. Default: \code{"UMI"}.}

\item{cutoff}{Adjusted p-value threshold for \code{CalculateRogue}. Default: \code{0.05}.}

\item{features}{Optional gene list to use for scoring.}

\item{verbose}{Logical, whether to print messages. Default: \code{TRUE}.}
}
\value{
A \code{data.frame} containing:
\itemize{
\item \code{label}: Sample identity or "All"
\item \code{cluster}: Cluster identity
\item \code{score}: ROGUE score
\item \code{group}: Source of the score (for faceting)
}
}
\description{
Computes \strong{ROGUE} (entropy-based) scores to evaluate cell population purity
from a Seurat object. Supports both global and per-cluster ROGUE computation.
}
\details{
\subsection{Modes:}{
\itemize{
\item If \code{clusters} and \code{label} are both \code{NULL}, computes global ROGUE score across all cells.
\item If both are provided, computes per-cluster ROGUE scores across samples.
}
}
}
\examples{
\dontrun{
# Global ROGUE score
sn_calculate_rogue(seurat_obj)

# Per-cluster ROGUE score
sn_calculate_rogue(seurat_obj, clusters = "seurat_clusters", label = "sample")

# Multiple clustering resolutions
sn_calculate_rogue(seurat_obj, clusters = c("res_0.4", "res_1.0"), label = "sample")
}

}
\references{
Liu, B., Li, C., Li, Z., Wang, D., Ren, X., & Zhang, Z. (2020).
An entropy-based metric for assessing the purity of single cell populations.
\emph{Nature Communications}, \strong{11}(1), 1â€“13.
\url{https://doi.org/10.1038/s41467-020-16904-3}
}
