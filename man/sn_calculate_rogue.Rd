% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seurat.R
\name{sn_calculate_rogue}
\alias{sn_calculate_rogue}
\title{Calculate ROGUE Score(s) from a Seurat Object}
\usage{
sn_calculate_rogue(
  x,
  cluster = NULL,
  sample = NULL,
  span = 0.9,
  min_cells = 10,
  min_genes = 10,
  platform = "UMI",
  cutoff = 0.05,
  features = NULL,
  verbose = TRUE
)
}
\arguments{
\item{x}{A Seurat object containing a \code{counts} layer.}

\item{cluster}{A character vector of one or more clustering columns in the metadata (\code{x@meta.data}).
If multiple, calculates mean ROGUE per column and identifies the elbow/knee point.}

\item{sample}{\emph{(Optional)} Column name indicating sample identity; required for per-cluster ROGUE.}

\item{span}{Smoothing parameter for \code{\link[ROGUE:rogue]{ROGUE::rogue()}} when \code{sample} is used. Default: \code{0.9}.}

\item{min_cells}{Minimum number of cells a gene must be expressed in. Default: \code{10}.}

\item{min_genes}{Minimum number of genes a cell must express. Default: \code{10}.}

\item{platform}{Either \code{"UMI"} (droplet-based) or \code{"full-length"} (SMART-seq, etc.).}

\item{cutoff}{Adjusted p-value cutoff for \code{\link[ROGUE:CalculateRogue]{ROGUE::CalculateRogue()}}. Default: \code{0.05}.}

\item{features}{\emph{(Optional)} Character vector of gene names to use. If \code{NULL}, all filtered genes are used.}

\item{verbose}{Whether to show progress messages. Default: \code{TRUE}.}
}
\value{
A \code{data.frame} with ROGUE results:
\itemize{
\item For \strong{multi-resolution comparison}:
Returns columns: \code{cluster}, \code{average_rogue}, \code{is_knee_point}.
\item For \strong{per-cluster analysis}:
Returns per-cluster ROGUE scores.
\item For \strong{global} (no cluster):
Returns ROGUE score vector.
}
}
\description{
Computes entropy-based \strong{ROGUE} scores to assess cluster purity from a Seurat object.
This function supports three usage modes:
}
\details{
\itemize{
\item \strong{Full dataset ROGUE} calculation (no cluster provided)
\item \strong{Per-cluster ROGUE} (when both \code{cluster} and \code{sample} are provided)
\item \strong{Multi-resolution ROGUE comparison}, using multiple \code{cluster} columns
}

The \strong{ROGUE} (Relative entropy Of Gene Usage Entropy) score quantifies the homogeneity of a cell population
using Shannon entropy. High ROGUE scores indicate purer (i.e., less heterogeneous) cell groups.

This function wraps around:
\itemize{
\item \code{\link[ROGUE:SE_fun]{ROGUE::SE_fun()}}
\item \code{\link[ROGUE:CalculateRogue]{ROGUE::CalculateRogue()}}
\item \code{\link[ROGUE:rogue]{ROGUE::rogue()}}
}
}
\examples{
\dontrun{
library(Seurat)
seurat_obj <- CreateSeuratObject(counts = example_matrix)
seurat_obj <- FindClusters(seurat_obj, resolution = c(0.2, 0.4, 0.6))

# Multi-resolution comparison
sn_calculate_rogue(seurat_obj, cluster = c("RNA_snn_res.0.2", "RNA_snn_res.0.4", "RNA_snn_res.0.6"))

# Per-cluster ROGUE
sn_calculate_rogue(seurat_obj, cluster = "seurat_clusters", sample = "sample_id")

# Global ROGUE
sn_calculate_rogue(seurat_obj)
}

}
\references{
Liu, B., Li, C., Li, Z., Wang, D., Ren, X., & Zhang, Z. (2020).
An entropy-based metric for assessing the purity of single cell populations.
\emph{Nature Communications}, \strong{11}(1), 1â€“13.
\url{https://doi.org/10.1038/s41467-020-16904-3}
}
